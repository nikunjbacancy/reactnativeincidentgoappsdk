{"version":3,"names":["_asyncStorage","_interopRequireDefault","require","_messaging","_api","_constants","_constants2","_types","_incidentCodeCore","_device","_notification","_backgroundGeolocation","_reactNativePushNotification","_messages","e","__esModule","default","sendLocalMessage","message","_message$data","_message$data2","_message$data4","_message$data5","_message$data6","_message$data8","_message$data9","_message$data10","_message$data11","_message$data12","_message$data15","_message$data16","_message$data19","_message$data20","_message$data21","_message$data22","_message$data25","data","type","IncidentType","Normal","event","_message$data3","emit","AppEvent","OnIncidentUpdated","tipId","Escort","PassiveEscort","_message$data7","OnEscortClosed","OnOrganizationGroupUpdated","_message$data13","_message$data14","console","log","JSON","stringify","sendLocalNotification","title","parse","userInfo","_message$data17","_message$data18","OnLogout","notification","_message$data23","_message$data24","incidentId","addBadge","escortState","AsyncStorage","getItem","ESCORT_STATE_KEY","EscortState","Started","setupFirebaseMessage","messaging","onMessage","_message$data52","_message$data53","isIos","_message$data26","_message$data27","_message$data30","_message$data31","_message$data32","_message$data35","_message$data36","_message$data37","_message$data38","_message$data39","_message$data40","_message$data41","_message$data43","_message$data44","_message$data45","_message$data46","_message$data47","_message$data48","_message$data49","_message$data28","_message$data29","options","NotificationTexts","myTips","tipDescription","PushNotification","localNotification","OnRefreshNotificationList","_message$data33","_message$data34","_message$notification","_message$notification2","body","_message$notification3","_message$notification4","_message$data42","siteKeyData","link","undefined","_message$notification5","_message$notification6","_message$data50","_message$data51","updateUserLocation","onNotificationOpenedApp","remoteMessage","_remoteMessage$data","getInitialNotification","then","_remoteMessage$data2","setBackgroundMessageHandler","_message$data54","_message$data55","_message$data56","_message$data57","_message$data58","_message$data62","_message$data63","setItem","ANDROID_HEADLESS_NOTIFICATION_KEY","_message$data59","_message$data60","_message$data61","payloaData","crudGeofenceOperation","isCron","_message$data64","_message$data65","_default","exports"],"sources":["setupFirebaseMessage.ts"],"sourcesContent":["import AsyncStorage from '@react-native-async-storage/async-storage';\nimport messaging, {\n  FirebaseMessagingTypes,\n} from '@react-native-firebase/messaging';\nimport { AppEvent, event } from '../../api';\nimport { ANDROID_HEADLESS_NOTIFICATION_KEY } from '../../containers/providers/NotificationProvider/constants';\nimport { ESCORT_STATE_KEY } from '../../containers/screens/Home/Escort/RecordScreen/constants';\nimport { EscortState } from '../../containers/screens/Home/Escort/RecordScreen/types';\nimport { Id, IncidentType } from 'incident-code-core';\nimport { sendLocalNotification } from '../device';\nimport { addBadge } from '../notification';\nimport { crudGeofenceOperation } from '../../utils/location/backgroundGeolocation';\nimport { isIos } from '../device';\nimport PushNotification from 'react-native-push-notification';\nimport { updateUserLocation } from '../../utils/location/backgroundGeolocation';\nimport NotificationTexts from './messages';\n\nconst sendLocalMessage = async (\n  message: FirebaseMessagingTypes.RemoteMessage,\n) => {\n  if (\n    message.data?.type === IncidentType.Normal &&\n    message.data?.event === 'resolved'\n  ) {\n    event.emit(AppEvent.OnIncidentUpdated, message.data?.tipId);\n    return;\n  }\n  // //(\"step -- 2\")\n  if (\n    (message.data?.type === IncidentType.Escort ||\n      message.data?.type === IncidentType.PassiveEscort) &&\n    message.data?.event === 'resolved'\n  ) {\n    event.emit(AppEvent.OnEscortClosed, message.data?.tipId);\n    return;\n  }\n  // //(\"step -- 3\")\n  // if (\n  //   message.data?.type === 'beacon' &&\n  //   message.data?.event === 'beaconUpdate'\n  // ) {\n  //   event.emit(AppEvent.OnBeaconUpdated, message.data);\n  //   return;\n  // }\n  // //(\"step -- 4\")\n  if (\n    message.data?.type === 'group' &&\n    message.data?.event === 'groupChanged' || message.data?.event === 'groupUpdated'\n  ) {\n    event.emit(AppEvent.OnOrganizationGroupUpdated, \"OnOrganizationGroupUpdated\");\n    return;\n  }\n\n  if (message.data?.type === 'Location' && message.data?.event === 'LocationQuestion') {\n    console.log(\"x\", JSON.stringify(message.data))\n    sendLocalNotification({\n      title: JSON.parse(message.data?.data).title,\n      message: JSON.parse(message.data?.data).message,\n      userInfo: message.data\n    });\n    return;\n  }\n  if (message.data?.type === 'chat' && message.data?.event === 'Message') {\n    // if (isAndroid) {\n    //   NativeModules.Bluetooth.awakeLockScreen();\n    // }\n    sendLocalNotification({\n      title: message.data?.event,\n      message: message.data?.data,\n      userInfo: message\n    });\n    return;\n  }\n  if (message.data?.type === 'logout_user') {\n    event.emit(AppEvent.OnLogout, message.notification);\n\n    return;\n  }\n\n  if (message.data?.type === 'Escort' && (message.data?.event === 'PanicCreated' || message.data?.event === 'PanicAccepted')) {\n    sendLocalNotification({\n      title: JSON.parse(message.data?.data).title,\n      message: JSON.parse(message.data?.data).message\n    });\n    return;\n  }\n\n  if (message.data?.incidentId) {\n    await addBadge(message.data.incidentId as Id);\n  }\n  const escortState = await AsyncStorage.getItem(ESCORT_STATE_KEY);\n  if (escortState === EscortState.Started) return;\n};\n\nconst setupFirebaseMessage = () => {\n  // messaging().onMessage((message: FirebaseMessagingTypes.RemoteMessage) => {\n  //   console.log(\"OnMessage ===>\",message)\n  //   if (isIos && message.data?.type === 'Escort' && (message.data?.event === 'PanicAccepted' || message.data?.event === 'PanicCreated')) {\n  //     PushNotification.localNotification({\n  //       // id:message?.messageId,\n  //       title: message?.notification?.title,\n  //       message: message?.notification?.body!,\n  //     });\n  //     return;\n  //   }\n\n  //   if (isIos && message.data?.type === 'chat' && message.data?.event === 'Message') {\n\n  //     PushNotification.localNotification({\n  //       // id:message?.messageId,\n  //       title: message?.notification?.title,\n  //       message: message?.notification?.body!,\n  //     });\n  //     return;\n  //   }\n\n  //   if (isIos &&\n  //     message.data?.type === 'group' &&\n  //     message.data?.event === 'groupChanged' || message.data?.event === 'groupUpdated'\n  //   ) {\n  //     event.emit(AppEvent.OnOrganizationGroupUpdated, \"OnOrganizationGroupUpdated\");\n  //     return;\n  //   }\n\n  //   if (isIos && message.data?.type === 'logout_user') {\n  //     event.emit(AppEvent.OnLogout, message?.notification);\n\n  //     return;\n  //   }\n\n\n  //   if (isIos == false) {\n  //     sendLocalMessage(message);\n  //   }\n\n  //   // update user locaiton on notification arrival\n  //   if (message.data?.type === 'silentPush' && message.data?.event === 'LocationUpdate') {\n  //     updateUserLocation()\n  //   }\n\n  // });\n\n  messaging().onMessage((message: FirebaseMessagingTypes.RemoteMessage) => {\n    console.log(\"onMessage=====>\", JSON.stringify(message))\n\n    if (isIos == false) {\n      sendLocalMessage(message);\n    } else {\n      if (message.data?.type === IncidentType.Normal && message.data?.event === 'resolved') {\n        let options = {\n          title: NotificationTexts.myTips,\n          message: NotificationTexts.tipDescription, // Reference message ID from translation file\n          userInfo: message\n        }\n        PushNotification.localNotification(options);\n        event.emit(AppEvent.OnIncidentUpdated, message.data?.tipId);\n        event.emit(AppEvent.OnRefreshNotificationList, message.data?.tipId);\n        return;\n      }\n      if ((message.data?.type === IncidentType.Escort || message.data?.type === IncidentType.PassiveEscort) && message.data?.event === 'resolved') {\n        event.emit(AppEvent.OnRefreshNotificationList, message.data?.tipId);\n        event.emit(AppEvent.OnEscortClosed, message.data?.tipId);\n        return;\n      }\n      if (message.data?.type === 'Escort' && (message.data?.event === 'PanicAccepted' || message.data?.event === 'PanicCreated')) {\n        let options = {\n          title: message?.notification?.title,\n          message: message?.notification?.body,\n        }\n        PushNotification.localNotification(options);\n        event.emit(AppEvent.OnRefreshNotificationList, message);\n        return;\n      }\n\n      if (message.data?.type === 'chat' && message.data?.event === 'Message') {\n        let options = {\n          title: message?.notification?.title,\n          message: message?.notification?.body,\n          userInfo: message\n        }\n        PushNotification.localNotification(options);\n        event.emit(AppEvent.OnRefreshNotificationList, message);\n        return;\n      }\n\n      // display site key notification when app is in foreground mode\n      if (message.data?.type === 'SiteKey' && message.data?.event === 'SiteKey') {\n        if (typeof message.data?.data === \"string\") {\n          const siteKeyData = JSON.parse(message.data.data);\n          let options = {\n            title: siteKeyData.title || \"\",\n            message: siteKeyData.message || \"\",\n            userInfo: message,\n          };\n          PushNotification.localNotification(options);\n        }\n        return;\n      }\n\n      // handle notify user notification\n      if (message?.data?.link != undefined) {\n\n        let options = {\n          title: message.notification?.title,\n          message: message.notification?.body,\n          userInfo: message\n        }\n        PushNotification.localNotification(options);\n        event.emit(AppEvent.OnRefreshNotificationList, \"NotifyUser\");\n      }\n\n      if (\n        message.data?.type === 'group' &&\n        message.data?.event === 'groupChanged' || message.data?.event === 'groupUpdated'\n      ) {\n        event.emit(AppEvent.OnRefreshNotificationList, \"OnOrganizationGroupUpdated\");\n        event.emit(AppEvent.OnOrganizationGroupUpdated, \"OnOrganizationGroupUpdated\");\n        return;\n      }\n\n      if (message.data?.type === 'logout_user') {\n        event.emit(AppEvent.OnLogout, message?.notification);\n        return;\n      }\n\n      // console.log(\"message.data?.type=>\",message.data?.type)\n      if (message.data?.type === 'Location' && message.data?.event === 'LocationQuestion') {\n        // console.log(\"locationquestion===>\", JSON.stringify(message.data))\n        sendLocalNotification({\n          title: JSON.parse(message.data?.data).title,\n          message: JSON.parse(message.data?.data).message,\n          userInfo: message.data\n        });\n        return;\n      }\n    }\n\n    // update user locaiton on notification arrival\n    if (message.data?.type === 'silentPush' && message.data?.event === 'LocationUpdate') {\n      updateUserLocation()\n    }\n\n  });\n\n  messaging().onNotificationOpenedApp(async (remoteMessage) => {\n    //('onNotificationOpenedApp', remoteMessage);\n    if (remoteMessage.data?.type === 'logout_user') {\n      event.emit(AppEvent.OnLogout, remoteMessage?.notification);\n    }\n  });\n\n  messaging()\n    .getInitialNotification()\n    .then(async (remoteMessage) => {\n      //('getInitialNotification*******',);\n      // //('getInitialNotification', remoteMessage.data?.type);\n\n      if (remoteMessage?.data?.type === 'logout_user') {\n        event.emit(AppEvent.OnLogout, remoteMessage?.notification);\n        // return;\n      }\n\n    });\n\n  messaging().setBackgroundMessageHandler(\n    async (message: FirebaseMessagingTypes.RemoteMessage) => {\n      console.log(\"background Handler message ===>\", message)\n      if (message.data?.incidentId) {\n        await AsyncStorage.setItem(\n          ANDROID_HEADLESS_NOTIFICATION_KEY,\n          message.data.incidentId,\n        );\n      }\n      // sendLocalMessage(message);\n\n      //update user location\n      if (message?.data?.type == \"silentPush\" && message?.data?.event == \"LocationUpdate\") {\n        updateUserLocation()\n      }\n\n      if (message.data?.type === 'geofence' && message.data?.event === 'polygon') {\n        const payloaData = typeof message.data?.data === 'string' ? JSON.parse(message.data.data) : message.data?.data;\n        crudGeofenceOperation(payloaData.data, message.data?.isCron)\n      }\n\n      if (message.data?.type === 'SiteKey' && message.data?.event === 'SiteKey') {\n        sendLocalNotification({\n          title: JSON.parse(message.data?.data).title,\n          message: JSON.parse(message.data?.data).message,\n          userInfo: message.data\n        });\n        return;\n      }\n\n    },\n  );\n};\n\nexport default setupFirebaseMessage;\n"],"mappings":"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","ignoreList":[]}