{"version":3,"names":["_immer","_interopRequireDefault","require","_map","_types","_constants","e","__esModule","default","initialState","exports","timer","undefined","procedure","actions","error","errorMessage","isLoadingProcedure","shouldShowSetTimerModal","isUserDefinedTimer","shouldShowCallModal","shouldShowSafeModal","shouldShowExitPanicModal","shouldShowPanicInfo","requestingImSafe","isPanicMode","warningTriggered","isCreatingPassiveEscort","incident","requestingVirtualEscort","activeCountdown","safetyTimer","countdownClockScreenReducer","produce","draft","action","type","GET_PROCEDURE_REQUEST","GET_PROCEDURE_SUCCESS","payload","GET_PROCEDURE_FAILURE","message","SHOW_SET_TIMER_MODAL","HIDE_SET_TIMER_MODAL","SET_TIMER_VALUE_SUCCESS","COMPLETE_PROCEDURE_ACTION","map","act","id","isCompleted","SHOW_CALL_MODAL","HIDE_CALL_MODAL","SHOW_SAFE_MODAL","HIDE_SAFE_MODAL","IM_SAFE_REQUEST","IM_SAFE_SUCCESS","IM_SAFE_FAILURE","SHOW_PANIC_INFO","HIDE_PANIC_INFO","ENTER_PANIC_MODE","ENTER_PANIC_MODE_SUCCESS","ENTER_PANIC_MODE_FAILURE","SHOW_EXIT_PANIC_MODAL","HIDE_EXIT_PANIC_MODAL","TRIGGER_COUNTDOWN_WARNING","CANCEL_COUNTDOWN_WARNING","START_PASSIVE_ESCORT_REQUEST","START_PASSIVE_ESCORT_SUCCESS","START_PASSIVE_ESCORT_FAILURE","START_VIRTUAL_ESCORT_REQUEST","START_VIRTUAL_ESCORT_SUCCESS","START_VIRTUAL_ESCORT_FAILURE","CLEAR_ARE_YOU_SAFE","finalAction","LOG_ESCORT_ACTION_FAILURE","CLEAR_ESCORT_ERROR","CLEAR_PROCEDURE","SET_SAFETY_TIMER","EscortType","Safety","name","organization","_default"],"sources":["reducer.ts"],"sourcesContent":["/**\n *\n * CountdownScreen reducer\n *\n */\n\nimport produce, { Draft } from 'immer';\nimport map from 'lodash/map';\n\nimport { EscortType } from '../EscortTypeScreen/types';\nimport {\n  CANCEL_COUNTDOWN_WARNING,\n  CLEAR_ARE_YOU_SAFE,\n  CLEAR_ESCORT_ERROR,\n  CLEAR_PROCEDURE,\n  COMPLETE_PROCEDURE_ACTION,\n  ENTER_PANIC_MODE,\n  ENTER_PANIC_MODE_FAILURE,\n  ENTER_PANIC_MODE_SUCCESS,\n  GET_PROCEDURE_FAILURE,\n  GET_PROCEDURE_REQUEST,\n  GET_PROCEDURE_SUCCESS,\n  HIDE_CALL_MODAL,\n  HIDE_EXIT_PANIC_MODAL,\n  HIDE_PANIC_INFO,\n  HIDE_SAFE_MODAL,\n  HIDE_SET_TIMER_MODAL,\n  IM_SAFE_FAILURE,\n  IM_SAFE_REQUEST,\n  IM_SAFE_SUCCESS,\n  LOG_ESCORT_ACTION_FAILURE,\n  SET_SAFETY_TIMER,\n  SET_TIMER_VALUE_SUCCESS,\n  SHOW_CALL_MODAL,\n  SHOW_EXIT_PANIC_MODAL,\n  SHOW_PANIC_INFO,\n  SHOW_SAFE_MODAL,\n  SHOW_SET_TIMER_MODAL,\n  START_PASSIVE_ESCORT_FAILURE,\n  START_PASSIVE_ESCORT_REQUEST,\n  START_PASSIVE_ESCORT_SUCCESS,\n  START_VIRTUAL_ESCORT_FAILURE,\n  START_VIRTUAL_ESCORT_REQUEST,\n  START_VIRTUAL_ESCORT_SUCCESS,\n  TRIGGER_COUNTDOWN_WARNING,\n} from './constants';\nimport { CountdownClockActionTypes, CountdownState } from './types';\n\nexport const initialState: CountdownState = {\n  timer: undefined,\n  procedure: undefined,\n  actions: undefined,\n  error: false,\n  errorMessage: '',\n  isLoadingProcedure: false,\n  shouldShowSetTimerModal: false,\n  isUserDefinedTimer: false,\n  shouldShowCallModal: false,\n  shouldShowSafeModal: false,\n  shouldShowExitPanicModal: false,\n  shouldShowPanicInfo: false,\n  requestingImSafe: false,\n  isPanicMode: false,\n  warningTriggered: false,\n  isCreatingPassiveEscort: false,\n  incident: undefined,\n  requestingVirtualEscort: false,\n  activeCountdown: false,\n  safetyTimer: false,\n};\n\nconst countdownClockScreenReducer = produce(\n  (draft: Draft<CountdownState>, action: CountdownClockActionTypes) => {\n    // //(\"action type--->\",action.type)\n    // //(\"action --->\",JSON.stringify(action))\n    switch (action.type) {\n      case GET_PROCEDURE_REQUEST:\n        draft.isLoadingProcedure = true;\n        break;\n      case GET_PROCEDURE_SUCCESS:\n        draft.procedure = action.payload;\n        draft.actions = action.payload.actions;\n        draft.timer = action.payload.timer;\n        draft.isUserDefinedTimer = action.payload.timer <= 0;\n        draft.isLoadingProcedure = false;\n        break;\n      case GET_PROCEDURE_FAILURE:\n        draft.error = action.error;\n        draft.errorMessage = action.payload.message;\n        draft.isLoadingProcedure = false;\n        break;\n      case SHOW_SET_TIMER_MODAL:\n        draft.shouldShowSetTimerModal = true;\n        break;\n      case HIDE_SET_TIMER_MODAL:\n        draft.shouldShowSetTimerModal = false;\n        break;\n      case SET_TIMER_VALUE_SUCCESS:\n        draft.timer = action.payload;\n        // //(\"draft timer --->\",draft.timer)\n        break;\n      case COMPLETE_PROCEDURE_ACTION:\n        draft.actions = map(draft.actions, act => {\n          if (act.id === action.payload) {\n            return {\n              ...act,\n              isCompleted: !act.isCompleted,\n            };\n          }\n          return {\n            ...act,\n          };\n        });\n        break;\n      case SHOW_CALL_MODAL:\n        draft.shouldShowCallModal = true;\n        break;\n      case HIDE_CALL_MODAL:\n        draft.shouldShowCallModal = false;\n        break;\n      case SHOW_SAFE_MODAL:\n        draft.shouldShowSafeModal = true;\n        break;\n      case HIDE_SAFE_MODAL:\n        draft.shouldShowSafeModal = false;\n        break;\n      case IM_SAFE_REQUEST:\n        draft.requestingImSafe = true;\n        break;\n      case IM_SAFE_SUCCESS:\n        draft.requestingImSafe = false;\n        draft.isPanicMode = false;\n        draft.activeCountdown = false;\n        draft.procedure = undefined;\n        draft.actions = undefined;\n        draft.timer = undefined;\n        draft.incident = undefined;\n        draft.safetyTimer = false;\n        break;\n      case IM_SAFE_FAILURE:\n        draft.requestingImSafe = false;\n        break;\n      case SHOW_PANIC_INFO:\n        draft.shouldShowPanicInfo = true;\n        break;\n      case HIDE_PANIC_INFO:\n        draft.shouldShowPanicInfo = false;\n        break;\n      case ENTER_PANIC_MODE:\n        draft.isPanicMode = true;\n        draft.activeCountdown = false;\n        draft.requestingVirtualEscort = true;\n        break;\n      case ENTER_PANIC_MODE_SUCCESS:\n        draft.isPanicMode = false;\n        draft.requestingVirtualEscort = false;\n        break;\n      case ENTER_PANIC_MODE_FAILURE:\n        draft.error = action.error;\n        draft.errorMessage = action.payload.message;\n        draft.requestingVirtualEscort = false;\n        break;\n      case SHOW_EXIT_PANIC_MODAL:\n        draft.shouldShowExitPanicModal = true;\n        break;\n      case HIDE_EXIT_PANIC_MODAL:\n        draft.shouldShowExitPanicModal = false;\n        break;\n      case TRIGGER_COUNTDOWN_WARNING:\n        draft.warningTriggered = true;\n        break;\n      case CANCEL_COUNTDOWN_WARNING:\n        draft.warningTriggered = false;\n        break;\n      case START_PASSIVE_ESCORT_REQUEST:\n        draft.isCreatingPassiveEscort = true;\n        break;\n      case START_PASSIVE_ESCORT_SUCCESS:\n        draft.isCreatingPassiveEscort = false;\n        draft.activeCountdown = true;\n        draft.incident = action.payload;\n        break;\n      case START_PASSIVE_ESCORT_FAILURE:\n        draft.isCreatingPassiveEscort = false;\n        break;\n      case START_VIRTUAL_ESCORT_REQUEST:\n        draft.activeCountdown = false;\n        draft.requestingVirtualEscort = true;\n        break;\n      case START_VIRTUAL_ESCORT_SUCCESS:\n        draft.requestingVirtualEscort = false;\n        break;\n      case START_VIRTUAL_ESCORT_FAILURE:\n        draft.error = action.error;\n        draft.errorMessage = action.payload.message;\n        draft.requestingVirtualEscort = false;\n        break;\n      case CLEAR_ARE_YOU_SAFE:\n        draft.actions = map(draft.actions, act => {\n          if (act.finalAction) {\n            return {\n              ...act,\n              isCompleted: false,\n            };\n          }\n          return {\n            ...act,\n          };\n        });\n        break;\n      case LOG_ESCORT_ACTION_FAILURE:\n        draft.error = action.error;\n        draft.errorMessage = action.payload.message;\n        break;\n      case CLEAR_ESCORT_ERROR:\n        draft.error = false;\n        draft.errorMessage = '';\n        break;\n      case CLEAR_PROCEDURE:\n        draft.procedure = undefined;\n        draft.actions = undefined;\n        draft.timer = undefined;\n        draft.isUserDefinedTimer = false;\n        draft.safetyTimer = false;\n        break;\n      case SET_SAFETY_TIMER:\n        draft.isUserDefinedTimer = true;\n        draft.timer = draft.timer ? draft.timer : 0; // Don't overwrite a timer that's been set already\n        draft.procedure = {\n          id: EscortType.Safety,\n          timer: 0,\n          name: 'Safety Timer',\n          actions: [],\n          organization: action.payload,\n        };\n        draft.safetyTimer = true;\n        break;\n      default:\n        break;\n    }\n  },\n  initialState,\n);\n\nexport default countdownClockScreenReducer;\n"],"mappings":"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","ignoreList":[]}