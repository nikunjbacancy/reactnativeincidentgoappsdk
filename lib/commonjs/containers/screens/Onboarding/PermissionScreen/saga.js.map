{"version":3,"names":["_screens","_interopRequireDefault","require","_effects","_reactNativePermissions","_device","_location","_navigation","_permission","_actions","_constants","e","__esModule","default","showMessageAndOpenPermissionConfigScreen","message","call","showOpenConfigMessage","openSettings","requestAllPermissionsSaga","payload","checkBlockedPermission","requestAllPermissions","goToNextScreen","error","isAndroid","put","allPermissionsSuccess","isActive","checkGPSStatus","nextScreen","Screens","Onboarding","PermissionLocation","ActivateGPS","Home","Index","NavigatorService","navigate","permissionScreenSaga","takeLatest","ALL_PERMISSIONS_REQUEST","GO_TO_NEXT_SCREEN"],"sources":["saga.ts"],"sourcesContent":["/**\n *\n * PermissionScreen saga\n *\n */\n\nimport Screens from '../../../../containers/providers/RoutesProvider/screens';\nimport { call, put, takeLatest } from 'redux-saga/effects';\nimport { openSettings } from 'react-native-permissions';\nimport { isAndroid } from '../../../../utils/device';\nimport { checkGPSStatus } from '../../../../utils/location';\nimport NavigatorService from '../../../../utils/navigation';\nimport {\n  checkBlockedPermission,\n  requestAllPermissions,\n  showOpenConfigMessage\n} from '../../../../utils/permission';\n\nimport { allPermissionsSuccess } from './actions';\nimport { ALL_PERMISSIONS_REQUEST, GO_TO_NEXT_SCREEN } from './constants';\nimport { AllPermissionsRequestAction } from './types';\n\nfunction* showMessageAndOpenPermissionConfigScreen(message: string) {\n  yield call(showOpenConfigMessage, message);\n  yield call(openSettings);\n}\n\nexport function* requestAllPermissionsSaga({\n  payload,\n}: AllPermissionsRequestAction) {\n  try {\n    yield call(checkBlockedPermission);\n    yield call(requestAllPermissions);\n    yield call(goToNextScreen);\n\n  } catch (error) {\n    yield call(showMessageAndOpenPermissionConfigScreen, payload);\n    yield call(goToNextScreen);\n    \n    // yield put(getAllGeofenceRequest(\"123\"))\n  }\n}\n\nfunction* goToNextScreen() {\n  if (isAndroid) {\n    yield put(allPermissionsSuccess());\n    const isActive = yield call(checkGPSStatus);\n    const nextScreen = isActive\n      ? Screens.Onboarding.PermissionLocation\n      : Screens.Onboarding.ActivateGPS;\n    if (nextScreen === Screens.Home.Index) {\n      yield call(NavigatorService.navigate, Screens.Onboarding.PermissionLocation);\n      // const isEnabled = yield call(checkBluetoothStatus);\n      // if (isEnabled) {\n      //   yield call(NavigatorService.navigate, nextScreen);\n      //   const beaconInfo = yield call(setUpBeaconInfo);\n      //   yield put(beaconRegistrationRequest(beaconInfo));\n      // }\n      // else {\n      //   yield call(NavigatorService.navigate, nextScreen);\n      // }\n    }\n    else {\n      yield call(NavigatorService.navigate, nextScreen);\n    }\n  } else {\n\n    yield put(allPermissionsSuccess());\n    yield call(NavigatorService.navigate, Screens.Onboarding.PermissionLocation);\n\n    // const location = yield call(getCachedFineGeoPoint);\n    // console.log(\"location:::::===>\" + JSON.stringify(location));\n    // if (location) {\n    //   // yield put(allPermissionsSuccess());\n    //   yield call(NavigatorService.navigate, Screens.Onboarding.PermissionLocation);\n    // }\n    // else {\n    //   // yield put(allPermissionsSuccess());\n    //   yield call(NavigatorService.navigate, Screens.Onboarding.PermissionLocation);\n    // }\n  }\n}\n\nexport default function* permissionScreenSaga() {\n  yield takeLatest(ALL_PERMISSIONS_REQUEST, requestAllPermissionsSaga);\n  yield takeLatest(GO_TO_NEXT_SCREEN, goToNextScreen);\n}\n\n"],"mappings":";;;;;;;AAMA,IAAAA,QAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,QAAA,GAAAD,OAAA;AACA,IAAAE,uBAAA,GAAAF,OAAA;AACA,IAAAG,OAAA,GAAAH,OAAA;AACA,IAAAI,SAAA,GAAAJ,OAAA;AACA,IAAAK,WAAA,GAAAN,sBAAA,CAAAC,OAAA;AACA,IAAAM,WAAA,GAAAN,OAAA;AAMA,IAAAO,QAAA,GAAAP,OAAA;AACA,IAAAQ,UAAA,GAAAR,OAAA;AAAyE,SAAAD,uBAAAU,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAnBzE;AACA;AACA;AACA;AACA;;AAkBA,UAAUG,wCAAwCA,CAACC,OAAe,EAAE;EAClE,MAAM,IAAAC,aAAI,EAACC,iCAAqB,EAAEF,OAAO,CAAC;EAC1C,MAAM,IAAAC,aAAI,EAACE,oCAAY,CAAC;AAC1B;AAEO,UAAUC,yBAAyBA,CAAC;EACzCC;AAC2B,CAAC,EAAE;EAC9B,IAAI;IACF,MAAM,IAAAJ,aAAI,EAACK,kCAAsB,CAAC;IAClC,MAAM,IAAAL,aAAI,EAACM,iCAAqB,CAAC;IACjC,MAAM,IAAAN,aAAI,EAACO,cAAc,CAAC;EAE5B,CAAC,CAAC,OAAOC,KAAK,EAAE;IACd,MAAM,IAAAR,aAAI,EAACF,wCAAwC,EAAEM,OAAO,CAAC;IAC7D,MAAM,IAAAJ,aAAI,EAACO,cAAc,CAAC;;IAE1B;EACF;AACF;AAEA,UAAUA,cAAcA,CAAA,EAAG;EACzB,IAAIE,iBAAS,EAAE;IACb,MAAM,IAAAC,YAAG,EAAC,IAAAC,8BAAqB,EAAC,CAAC,CAAC;IAClC,MAAMC,QAAQ,GAAG,MAAM,IAAAZ,aAAI,EAACa,wBAAc,CAAC;IAC3C,MAAMC,UAAU,GAAGF,QAAQ,GACvBG,gBAAO,CAACC,UAAU,CAACC,kBAAkB,GACrCF,gBAAO,CAACC,UAAU,CAACE,WAAW;IAClC,IAAIJ,UAAU,KAAKC,gBAAO,CAACI,IAAI,CAACC,KAAK,EAAE;MACrC,MAAM,IAAApB,aAAI,EAACqB,mBAAgB,CAACC,QAAQ,EAAEP,gBAAO,CAACC,UAAU,CAACC,kBAAkB,CAAC;MAC5E;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;IACF,CAAC,MACI;MACH,MAAM,IAAAjB,aAAI,EAACqB,mBAAgB,CAACC,QAAQ,EAAER,UAAU,CAAC;IACnD;EACF,CAAC,MAAM;IAEL,MAAM,IAAAJ,YAAG,EAAC,IAAAC,8BAAqB,EAAC,CAAC,CAAC;IAClC,MAAM,IAAAX,aAAI,EAACqB,mBAAgB,CAACC,QAAQ,EAAEP,gBAAO,CAACC,UAAU,CAACC,kBAAkB,CAAC;;IAE5E;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;EACF;AACF;AAEe,UAAUM,oBAAoBA,CAAA,EAAG;EAC9C,MAAM,IAAAC,mBAAU,EAACC,kCAAuB,EAAEtB,yBAAyB,CAAC;EACpE,MAAM,IAAAqB,mBAAU,EAACE,4BAAiB,EAAEnB,cAAc,CAAC;AACrD","ignoreList":[]}