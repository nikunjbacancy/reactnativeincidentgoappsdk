{"version":3,"names":["api","geoDistance","map","reverse","call","delay","put","spawn","takeLatest","convertToGiftedChatMessage","handleError","getCachedFineGeoPoint","getCachedFineLatLng","getTipsRequest","resetState","TipStatus","addIncidentVideo","getIncidentFailure","getIncidentSuccess","getIncidentVideosFailure","getIncidentVideosSuccess","getMessagesFailure","getMessagesRequest","getMessagesSuccess","sendMessageFailure","sendMessageSuccess","uploadVideoFailure","uploadVideoSuccess","GET_INCIDENT_REQUEST","GET_INCIDENT_VIDEOS_REQUEST","GET_MESSAGES_REQUEST","SEND_MESSAGE_REQUEST","UPLOAD_VIDEO_REQUEST","getIncidentVideos","payload","videosResponse","incidents","getVideos","incident","id","organizationResponse","organizations","getOrganization","organizationId","organization","data","videos","error","uploadVideo","uploadVideoInParallel","options","getAmazonS3Options","isUploaded","checkVideoUploadCompletion","logger","debug","warn","amazonOptionsResponse","getAmazonOptions","videoUri","i","response","getVideo","Error","getMessages","isResolved","getChat","messages","message","_incident$id","hasChat","location","startChat","category","comment","twilio","toString","tipStatus","Active","paging","Closed","sendMessage","_location$coordinates","_location$coordinates2","_geocodeResponse$data","_payload$incident$id","geocodeResponse","user","getAddress","coordinates","address","results","formatted_address","messageAttributes","text","addLocation","_incident$location","_incident$location2","l1","l2","lng","lat","distance","getIncident","tipDetailScreenSaga"],"sources":["saga.ts"],"sourcesContent":["/**\n *\n * TipDetailScreen saga\n *\n */\n\nimport * as api from '../../../../../api';\nimport { AxiosResponse } from 'axios';\nimport {\n  geoDistance,\n  Id,\n  Incident,\n  IncidentChat,\n  IncidentVideo,\n  IncidentVideoUploadOptions,\n  LatLng,\n  Organization,\n  QueryResult,\n} from 'incident-code-core';\nimport { GeoPoint } from 'incident-code-core/dist/types';\nimport map from 'lodash/map';\nimport reverse from 'lodash/reverse';\nimport { IMessage as GiftedChatMessage } from 'react-native-gifted-chat';\nimport { call, delay, put, spawn, takeLatest } from 'redux-saga/effects';\nimport { GeocodeResponse } from '../../../../../types';\nimport { convertToGiftedChatMessage } from '../../../../../utils/chat';\nimport { handleError } from '../../../../../utils/error';\nimport { getCachedFineGeoPoint, getCachedFineLatLng } from '../../../../../utils/location';\n\nimport { getTipsRequest, resetState } from '../MyTipsScreen/actions';\nimport { TipStatus } from '../MyTipsScreen/types';\nimport {\n  addIncidentVideo,\n  getIncidentFailure,\n  getIncidentSuccess,\n  getIncidentVideosFailure,\n  getIncidentVideosSuccess,\n  getMessagesFailure,\n  getMessagesRequest,\n  getMessagesSuccess,\n  sendMessageFailure,\n  sendMessageSuccess,\n  uploadVideoFailure,\n  uploadVideoSuccess,\n} from './actions';\nimport {\n  GET_INCIDENT_REQUEST,\n  GET_INCIDENT_VIDEOS_REQUEST,\n  GET_MESSAGES_REQUEST,\n  SEND_MESSAGE_REQUEST,\n  UPLOAD_VIDEO_REQUEST,\n} from './constants';\nimport {\n  GetIncidentRequestAction,\n  GetIncidentVideosRequestAction,\n  GetMessagesRequestAction,\n  SendMessageRequestAction,\n  UploadVideoRequestAction,\n  UploadVideoRequestPayload,\n} from './types';\n\nfunction* getIncidentVideos({ payload }: GetIncidentVideosRequestAction) {\n  try {\n    const videosResponse: AxiosResponse<QueryResult<\n      IncidentVideo\n    >> = yield call(api.incidents.getVideos, payload.incident.id);\n\n    const organizationResponse: AxiosResponse<Organization> = yield call(\n      api.organizations.getOrganization,\n      payload.organizationId,\n    );\n\n    yield put(\n      getMessagesRequest({\n        incident: payload.incident,\n        organization: organizationResponse.data,\n      }),\n    );\n\n    yield put(\n      getIncidentVideosSuccess({\n        videos: reverse(videosResponse.data.data || []),\n        organization: organizationResponse.data,\n      }),\n    );\n  } catch (error: any) {\n    yield put(getIncidentVideosFailure(handleError(error)));\n  }\n}\n\nexport function* uploadVideo({ payload }: UploadVideoRequestAction) {\n  yield spawn(uploadVideoInParallel, payload);\n}\n\nfunction* uploadVideoInParallel(payload: UploadVideoRequestPayload):any {\n  try {\n    const options = yield call(getAmazonS3Options, payload);\n\n    // add empty video card\n    yield put(addIncidentVideo({ id: options.id, isUploaded: false }));\n\n    yield call(api.incidents.uploadVideo, options);\n\n    yield call(checkVideoUploadCompletion, options);\n\n    yield put(uploadVideoSuccess());\n\n    api.logger.debug('UploadVideo', 'Success');\n  } catch (error: any) {\n    api.logger.warn('UploadVideo', 'Upload Failed', error);\n    yield put(uploadVideoFailure(handleError(error)));\n  }\n}\n\nfunction* getAmazonS3Options(payload: UploadVideoRequestPayload) {\n  try {\n    // get amazon S3 authorization\n    const amazonOptionsResponse: AxiosResponse<IncidentVideoUploadOptions> = yield call(\n      api.incidents.getAmazonOptions,\n      payload.incident,\n      payload.videoUri,\n    );\n\n    api.logger.debug('Get S3 options', 'Success', amazonOptionsResponse.data);\n\n    return amazonOptionsResponse.data;\n  } catch (error: any) {\n    api.logger.warn('Get S3 options', 'Failed', error);\n    yield put(uploadVideoFailure(handleError(error)));\n    return;\n  }\n}\n\nfunction* checkVideoUploadCompletion(options: IncidentVideoUploadOptions) {\n  for (let i = 0; i < 10; i += 1) {\n    try {\n      const response: AxiosResponse<IncidentVideo> = yield call(\n        api.incidents.getVideo,\n        options.id,\n      );\n      if (response.data.isUploaded) {\n        yield put(addIncidentVideo(response.data));\n        api.logger.debug('CheckVideoUpload', 'Success', response.data);\n        return;\n      }\n    } catch (error: any) {\n      api.logger.warn('CheckVideoUpload', 'Failed', error);\n    } finally {\n      yield delay(2000);\n    }\n  }\n  throw new Error('Upload video to S3 failed');\n}\n\nfunction* getMessages({\n  payload: { incident, organization },\n}: GetMessagesRequestAction):any {\n  try {\n    if (incident.isResolved) {\n      const response: AxiosResponse<IncidentChat> = yield call(\n        api.incidents.getChat,\n        incident.id as Id,\n      );\n      if (response.data && response.data.messages) {\n        // //(\"-response.data.messages--->\",JSON.stringify(response.data.messages))\n        const messages: GiftedChatMessage[] = map(\n          response.data.messages,\n          message => convertToGiftedChatMessage(message),\n        );\n        yield put(getMessagesSuccess(messages));\n      }\n    } else {\n      if (!incident.hasChat) {\n        const location = yield call(getCachedFineGeoPoint);\n        yield call(api.incidents.startChat, {\n          incident: incident.id as Id,\n          organization: organization.id as Id,\n          category: incident.category,\n          comment: incident.comment,\n          location,\n        });\n      }\n      const messages: GiftedChatMessage[] = yield call(\n        api.twilio.getMessages,\n        incident.id?.toString() || '',\n      );\n      yield put(getMessagesSuccess(messages));\n      yield put(resetState());\n      yield put(getTipsRequest({ tipStatus: TipStatus.Active, paging: false }));\n      yield put(getTipsRequest({ tipStatus: TipStatus.Closed, paging: false }));\n    }\n  } catch (error: any) {\n    yield put(getMessagesFailure(handleError(error)));\n  }\n}\n\nfunction* sendMessage({ payload }: SendMessageRequestAction) {\n  try {\n    const location: GeoPoint = yield call(getCachedFineGeoPoint);\n    const geocodeResponse: AxiosResponse<GeocodeResponse> = yield call(\n      api.user.getAddress,\n      location.coordinates?.[1] || 0,\n      location.coordinates?.[0] || 0,\n    );\n    const address = geocodeResponse.data.results[0]?.formatted_address || '';\n    const messageAttributes = {\n      location,\n      address,\n    };\n    yield call(\n      api.twilio.sendMessage,\n      payload.incident.id?.toString() || '',\n      payload.message.text,\n      messageAttributes,\n    );\n    yield call(addLocation, payload.incident);\n    yield put(sendMessageSuccess());\n  } catch (error: any) {\n    yield put(sendMessageFailure(handleError(error)));\n  }\n}\n\nfunction* addLocation(incident: Incident) {\n  const l1: LatLng = yield call(getCachedFineLatLng);\n  const l2: LatLng = {\n    lng: incident.location?.coordinates?.[0] || l1.lng,\n    lat: incident.location?.coordinates?.[1] || l1.lat,\n  };\n\n  const distance = geoDistance(l1.lat, l1.lng, l2.lat, l2.lng);\n\n  // don't send if the change is no more than 20 meter\n  if (distance >= 20) {\n    yield call(api.incidents.addLocation, incident.id as Id, l1);\n  }\n}\n\nfunction* getIncident({ payload }: GetIncidentRequestAction) {\n  try {\n    const response: AxiosResponse<Incident> = yield call(\n      api.incidents.getIncident,\n      payload || '',\n    );\n    yield put(getIncidentSuccess(response.data));\n  } catch (error: any) {\n    yield put(getIncidentFailure(handleError(error)));\n  }\n}\n\nexport default function* tipDetailScreenSaga() {\n  yield takeLatest(GET_INCIDENT_VIDEOS_REQUEST, getIncidentVideos);\n  yield takeLatest(UPLOAD_VIDEO_REQUEST, uploadVideo);\n  yield takeLatest(GET_MESSAGES_REQUEST, getMessages);\n  yield takeLatest(SEND_MESSAGE_REQUEST, sendMessage);\n  yield takeLatest(GET_INCIDENT_REQUEST, getIncident);\n}\n"],"mappings":"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","ignoreList":[]}