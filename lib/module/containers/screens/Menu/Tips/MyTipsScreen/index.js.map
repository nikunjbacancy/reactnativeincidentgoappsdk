{"version":3,"names":["AppEvent","event","colors","LoadingIndicator","SafeAreaContainer","ScreenActionButton","Screens","filter","React","useCallback","useEffect","useState","StatusBar","TouchableOpacity","withNavigationFocus","useAction","useSelector","NavigatorService","getBadges","getTipsRequest","NoData","makeSelectIsLoading","makeSelectTips","BackButtonRow","Container","List","TipItem","MyTipsScreen","isFocused","navigation","getParam","tipStatus","badges","setBadges","getTipsRequestAction","tips","isLoading","paging","then","notificationBadges","onIncidentUpdated","notificationAdded","on","OnNotificationBadge","OnIncidentUpdated","componentDidUnMount","off","onEndReached","hasMoreData","goToTipDetail","incident","navigate","Menu","Tips","TipDetail","renderReportItem","item","_item$id","createElement","onPress","b","id","key","toString","Fragment","barStyle","backgroundColor","data","keyExtractor","_item$id2","renderItem","ListEmptyComponent","onEndReachedThreshold","onCancel","Home","Escort","EscortType","tintColor","white"],"sources":["index.tsx"],"sourcesContent":["import { AppEvent, event } from '../../../../../api';\nimport { colors } from '../../../../../assets';\nimport {\n  LoadingIndicator,\n  SafeAreaContainer,\n  ScreenActionButton,\n} from '../../../../../components';\nimport Screens from '../../../../../containers/providers/RoutesProvider/screens';\nimport { Id, Incident } from 'incident-code-core';\nimport filter from 'lodash/filter';\nimport React, { FC, useCallback, useEffect, useState } from 'react';\nimport { StatusBar, TouchableOpacity } from 'react-native';\nimport { ScreenProps } from 'react-native-screens';\nimport { withNavigationFocus } from 'react-navigation';\nimport { NavigationStackScreenProps } from 'react-navigation-stack';\nimport { useAction, useSelector } from '../../../../../utils/hooks';\nimport NavigatorService from '../../../../../utils/navigation';\nimport { getBadges } from '../../../../../utils/notification';\n\nimport { getTipsRequest } from './actions';\nimport NoData from './NoData';\nimport { makeSelectIsLoading, makeSelectTips } from './selectors';\nimport { BackButtonRow, Container, List } from './styles';\nimport TipItem from './TipItem';\nimport { TipStatus } from './types';\n\ninterface ItemIncident {\n  item: Incident;\n}\ninterface Params {\n  tipStatus: TipStatus;\n}\ninterface Props extends NavigationStackScreenProps<Params, ScreenProps> {\n  isFocused: boolean;\n}\n\nconst MyTipsScreen: FC<Props> = ({ isFocused, navigation: { getParam } }) => {\n  const tipStatus = getParam('tipStatus');\n\n  const [badges, setBadges] = useState<Id[]>([]);\n\n  const getTipsRequestAction = useAction(getTipsRequest);\n\n  const tips = useSelector(makeSelectTips());\n  const isLoading = useSelector(makeSelectIsLoading());\n\n  useEffect(() => {\n    getTipsRequestAction({ tipStatus, paging: false });\n  }, [isFocused, tipStatus]);\n\n  useEffect(() => {\n    getBadges().then((notificationBadges: Id[]) => {\n      setBadges(notificationBadges);\n    });\n    const onIncidentUpdated = () => {\n      getTipsRequestAction({ tipStatus, paging: false });\n    };\n    const notificationAdded = (notificationBadges: Id[]) => {\n      setBadges(notificationBadges);\n    };\n    event.on(AppEvent.OnNotificationBadge, notificationAdded);\n    event.on(AppEvent.OnIncidentUpdated, onIncidentUpdated);\n    return function componentDidUnMount() {\n      event.off(AppEvent.OnNotificationBadge, notificationAdded);\n      event.off(AppEvent.OnIncidentUpdated, onIncidentUpdated);\n    };\n  }, [setBadges]);\n\n  const onEndReached = useCallback(() => {\n    if (tips[tipStatus].hasMoreData) {\n      getTipsRequestAction({ tipStatus, paging: true });\n    }\n  }, [tips, tipStatus]);\n\n  const goToTipDetail = (incident: Incident) => {\n    NavigatorService.navigate(Screens.Menu.Tips.TipDetail, { incident });\n  };\n\n  const renderReportItem = ({ item }: ItemIncident) => {\n    return (\n      <TouchableOpacity onPress={() => goToTipDetail(item)}>\n        <TipItem\n          badges={filter(badges, b => b === item?.id)}\n          key={item?.id?.toString()}\n          incident={item}\n        />\n      </TouchableOpacity>\n    );\n  };\n\n  return (\n    <>\n      <StatusBar barStyle=\"dark-content\" backgroundColor=\"white\" />\n      <SafeAreaContainer>\n        <Container>\n          <List\n            data={tips[tipStatus].data}\n            keyExtractor={(item: any) => item.id?.toString() || ''}\n            renderItem={renderReportItem}\n            ListEmptyComponent={isLoading ? <LoadingIndicator /> : <NoData />}\n            onEndReached={onEndReached}\n            onEndReachedThreshold={2}\n          />\n        </Container>\n        <BackButtonRow>\n          <ScreenActionButton\n            onCancel={() =>\n              NavigatorService.navigate(Screens.Home.Escort.EscortType)\n            }\n            tintColor={colors.white}\n          />\n        </BackButtonRow>\n      </SafeAreaContainer>\n    </>\n  );\n};\n\nexport default withNavigationFocus(MyTipsScreen);\n"],"mappings":"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","ignoreList":[]}