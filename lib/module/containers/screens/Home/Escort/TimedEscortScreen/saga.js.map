{"version":3,"names":["api","triggerOnboardForInactiveUser","call","put","takeLatest","handleError","getCachedFineGeoPoint","getIntersectOrganizationsFailure","getIntersectOrganizationsSuccess","getOrganizationProceduresFailure","getOrganizationProceduresSuccess","toggleSelectOrganization","GET_INTERSECT_ORGANIZATIONS_REQUEST","GET_ORGANIZATION_PROCEDURES_REQUEST","getIntersectOrganizations","console","log","location","response","organizations","findIntersectOrganizations","data","length","_response$data$organi","id","error","getOrganizationProcedures","payload","organizationNotifyScreenSaga"],"sources":["saga.ts"],"sourcesContent":["/**\n *\n * SelectOrganizationScreen saga\n *\n */\n\nimport * as api from '../../../../../api';\nimport { AxiosResponse } from 'axios';\nimport { triggerOnboardForInactiveUser } from '../../../../../containers/app/saga';\nimport { GeoPoint, Id, OrganizationProcedure } from 'incident-code-core';\nimport { call, put, takeLatest } from 'redux-saga/effects';\nimport { handleError } from '../../../../../utils/error';\nimport { getCachedFineGeoPoint } from '../../../../../utils/location';\n\nimport {\n  getIntersectOrganizationsFailure,\n  getIntersectOrganizationsSuccess,\n  getOrganizationProceduresFailure,\n  getOrganizationProceduresSuccess,\n  toggleSelectOrganization,\n} from './actions';\nimport {\n  GET_INTERSECT_ORGANIZATIONS_REQUEST,\n  GET_ORGANIZATION_PROCEDURES_REQUEST,\n} from './constants';\nimport { GetOrganizationProceduresRequestAction } from './types';\n\nfunction* getIntersectOrganizations(): any {\n  try {\n    console.log(\"===getIntersectOrganizations=====\")\n    const location: GeoPoint = yield call(getCachedFineGeoPoint);\n    console.log(\"getIntersectOrganizations location==>\",location)\n    const response = yield call(\n      api.organizations.findIntersectOrganizations,\n      location,\n    );\n    console.log(\"getIntersectOrganizations location response==>\",response)\n    yield put(getIntersectOrganizationsSuccess(response.data));\n    if (response.data.organizations.length === 0) {\n      yield* triggerOnboardForInactiveUser();\n    }\n    if (response.data.organizations.length === 1) {\n      yield put(\n        toggleSelectOrganization(response.data.organizations[0]?.id as Id),\n      );\n    }\n  } catch (error: any) {\n    console.log(\"getIntersectOrganizationsFailure location error==>\",error)\n    yield put(getIntersectOrganizationsFailure(handleError(error)));\n  }\n}\n\nfunction* getOrganizationProcedures({\n  payload,\n}: GetOrganizationProceduresRequestAction) {\n  try {\n    const response: AxiosResponse<OrganizationProcedure[]> = yield call(\n      api.organizations.getOrganizationProcedures,\n      payload,\n    );\n    console.log(\"getOrganizationProcedures success==>\",response)\n    yield put(getOrganizationProceduresSuccess(response.data));\n  } catch (error: any) {\n    console.log(\"getOrganizationProcedures error==>\",error)\n    yield put(getOrganizationProceduresFailure(handleError(error)));\n  }\n}\n\nexport default function* organizationNotifyScreenSaga() {\n  yield takeLatest(\n    GET_INTERSECT_ORGANIZATIONS_REQUEST,\n    getIntersectOrganizations,\n  );\n  yield takeLatest(\n    GET_ORGANIZATION_PROCEDURES_REQUEST,\n    getOrganizationProcedures,\n  );\n}\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;;AAEA,OAAO,KAAKA,GAAG,MAAM,oBAAoB;AAEzC,SAASC,6BAA6B,QAAQ,oCAAoC;AAElF,SAASC,IAAI,EAAEC,GAAG,EAAEC,UAAU,QAAQ,oBAAoB;AAC1D,SAASC,WAAW,QAAQ,4BAA4B;AACxD,SAASC,qBAAqB,QAAQ,+BAA+B;AAErE,SACEC,gCAAgC,EAChCC,gCAAgC,EAChCC,gCAAgC,EAChCC,gCAAgC,EAChCC,wBAAwB,QACnB,WAAW;AAClB,SACEC,mCAAmC,EACnCC,mCAAmC,QAC9B,aAAa;AAGpB,UAAUC,yBAAyBA,CAAA,EAAQ;EACzC,IAAI;IACFC,OAAO,CAACC,GAAG,CAAC,mCAAmC,CAAC;IAChD,MAAMC,QAAkB,GAAG,MAAMf,IAAI,CAACI,qBAAqB,CAAC;IAC5DS,OAAO,CAACC,GAAG,CAAC,uCAAuC,EAACC,QAAQ,CAAC;IAC7D,MAAMC,QAAQ,GAAG,MAAMhB,IAAI,CACzBF,GAAG,CAACmB,aAAa,CAACC,0BAA0B,EAC5CH,QACF,CAAC;IACDF,OAAO,CAACC,GAAG,CAAC,gDAAgD,EAACE,QAAQ,CAAC;IACtE,MAAMf,GAAG,CAACK,gCAAgC,CAACU,QAAQ,CAACG,IAAI,CAAC,CAAC;IAC1D,IAAIH,QAAQ,CAACG,IAAI,CAACF,aAAa,CAACG,MAAM,KAAK,CAAC,EAAE;MAC5C,OAAOrB,6BAA6B,CAAC,CAAC;IACxC;IACA,IAAIiB,QAAQ,CAACG,IAAI,CAACF,aAAa,CAACG,MAAM,KAAK,CAAC,EAAE;MAAA,IAAAC,qBAAA;MAC5C,MAAMpB,GAAG,CACPQ,wBAAwB,EAAAY,qBAAA,GAACL,QAAQ,CAACG,IAAI,CAACF,aAAa,CAAC,CAAC,CAAC,cAAAI,qBAAA,uBAA9BA,qBAAA,CAAgCC,EAAQ,CACnE,CAAC;IACH;EACF,CAAC,CAAC,OAAOC,KAAU,EAAE;IACnBV,OAAO,CAACC,GAAG,CAAC,oDAAoD,EAACS,KAAK,CAAC;IACvE,MAAMtB,GAAG,CAACI,gCAAgC,CAACF,WAAW,CAACoB,KAAK,CAAC,CAAC,CAAC;EACjE;AACF;AAEA,UAAUC,yBAAyBA,CAAC;EAClCC;AACsC,CAAC,EAAE;EACzC,IAAI;IACF,MAAMT,QAAgD,GAAG,MAAMhB,IAAI,CACjEF,GAAG,CAACmB,aAAa,CAACO,yBAAyB,EAC3CC,OACF,CAAC;IACDZ,OAAO,CAACC,GAAG,CAAC,sCAAsC,EAACE,QAAQ,CAAC;IAC5D,MAAMf,GAAG,CAACO,gCAAgC,CAACQ,QAAQ,CAACG,IAAI,CAAC,CAAC;EAC5D,CAAC,CAAC,OAAOI,KAAU,EAAE;IACnBV,OAAO,CAACC,GAAG,CAAC,oCAAoC,EAACS,KAAK,CAAC;IACvD,MAAMtB,GAAG,CAACM,gCAAgC,CAACJ,WAAW,CAACoB,KAAK,CAAC,CAAC,CAAC;EACjE;AACF;AAEA,eAAe,UAAUG,4BAA4BA,CAAA,EAAG;EACtD,MAAMxB,UAAU,CACdQ,mCAAmC,EACnCE,yBACF,CAAC;EACD,MAAMV,UAAU,CACdS,mCAAmC,EACnCa,yBACF,CAAC;AACH","ignoreList":[]}